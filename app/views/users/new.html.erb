<h1 class="text-center fw-bold" style="
  font-size: 80px;
  color: #93FD00; /* 黄緑 */    
  text-shadow: 1px 1px 0 #4DE33F, -1px -1px 0 #4DE33F; /* 黄緑の外枠風 */
">
  <%= t("user.registration.title") %>
</h1>

<%= form_with model: @user, url: users_path, local: true do |f| %>
  <div style="display: flex; justify-content: center; margin-top: 80px;">  
    <div class="mb-3">
      <%= f.label :name, t("activerecord.attributes.user.name"), style: "font-size:36px; display: block; margin-bottom: 8px;" %>
      <%= f.text_field :name, style: "width:1200px; height:50px; border-radius:8px;" %>
    </div>
  </div>
  
  <div style="display: flex; justify-content: center; margin-top: 20px;">
    <div class="mb-3">
      <%= f.label :email, t("activerecord.attributes.user.email"),style: "font-size:36px; display: block; margin-bottom: 8px;" %>
      <%= f.email_field :email, style: "width:1200px; height:50px; border-radius:8px;" %>
    </div>
  </div>

  <div style="display: flex; justify-content: center; margin-top: 20px;">
    <div class="mb-3">
      <%= f.label :password,t("activerecord.attributes.user.password"),style: "font-size:36px; display: block; margin-bottom: 8px;" %>
      <%= f.password_field :password, style: "width:1200px; height:50px; border-radius:8px;" %>
    </div>
  </div>

  <div style="display: flex; justify-content: center; margin-top: 20px;">
    <div class="mb-3">
      <%= f.label :password_confirmation,t("activerecord.attributes.user.password_confirmation"),style: "font-size:36px; display: block; margin-bottom: 8px;" %>
      <%= f.password_field :password_confirmation, style: "width:1200px; height:50px; border-radius:8px;" %>
    </div>
  </div>
  
  <div style="display: flex; justify-content: center; margin-top: 20px;">
    <div style="max-width: 1200px; width: 100%; display: flex; flex-direction: column; align-items: flex-start;">
      <label style="font-size: 28px; font-weight: bold; margin-bottom: 8px;">
        アイコン画像
      </label>
      <button type="button"
        class="btn btn-outline-success"
        data-bs-toggle="modal"
        data-bs-target="#avatarModal"
        style="font-size: 28px; padding: 12px 32px; border-radius: 10px;">
       挿入
      </button>

    </div>
  </div>

  <div class="modal fade" id="avatarModal" tabindex="-1" aria-labelledby="avatarModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="avatarModalLabel">アイコン画像</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
        </div>
        <div class="modal-body">
          <%= f.label :avatar, t("activerecord.attributes.user.avatar"), class: "form-label", style: "font-size: 24px;" %>
          <%= f.file_field :avatar, class: "form-control", onchange: "previewAvatar(event)", style: "margin-bottom: 20px;" %>
          <div style="width: 200px; height: 200px; border-radius: 50%; overflow: hidden; margin: 0 auto; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
            <img id="avatar-preview" style="width: 100%; height: 100%; object-fit: cover;" />
            <label for="position-slider" style="font-size: 18px;">横位置の調整</label>
            <input type="range" id="position-slider" min="0" max="100" value="50" onchange="adjustPosition(this.value)" style="width: 200px;">
          </div>
        </div>
        <div class="modal-footer d-flex justify-content-between">
          <button type="button" onclick="clearAvatar()" class="btn btn-outline-danger"><%= t("user.registration.avatar_button") %></button>
         <div>
          <button type="button" class="btn btn-success" data-bs-dismiss="modal"><%= t("user.registration.avatar_confirm") %></button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><%= t("user.registration.cancel") %></button>
         </div>
        </div>
      </div>
    </div>
  </div>

  <div style="display: flex; justify-content: center; margin-top: 40px;">
    <%= f.submit t("helpers.submit.user.create"), class: "btn btn-outline-lime" %>
  </div>
<% end %>


<script>
  function previewAvatar(event) {
    const reader = new FileReader();
    reader.onload = function(){
      document.getElementById('avatar-preview').src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
  }

  function adjustPosition(value) {
    const preview = document.getElementById('avatar-preview');
    preview.style.objectPosition = `${value}% center`;
  }

  function clearAvatar() {
    const input = document.querySelector('input[type="file"]');
    input.value = "";
    document.getElementById('avatar-preview').src = "";
  }
</script>
